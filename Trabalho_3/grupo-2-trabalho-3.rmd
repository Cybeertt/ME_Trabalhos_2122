---
title: 'Trabalho de Grupo III'
subtitle: 'Unidade Curricular : Métodos Estatísticos'
author: 
- Grupo 1, Turma SW-05
- name: N.200221146 Beatriz Simões
  affiliation: IPS EST Setúbal, LEI, ramo gestão
- name: N.150221081 Daniela Sineiro
  affiliation: IPS EST Setúbal, LEI, ramo software
- name: N.200221149 Rafael Palma
  affiliation: IPS EST Setúbal, LEI, ramo software
date: "`r format(Sys.time(), '%d %B %Y')`"
lang: [BCP 47]
description: 'Observação dos dados e aplicar cálculos de ???, comentando observações sobre alguns resultados'
output: 
  word_document: default
  html_document: default
  pdf_document: default
...

```{r setup, include = F}
knitr::opts_chunk$set(echo = F)
```
******

## **Índice**

+ [1. Descrição dos Dados](#desc)
+ [2. Dados em Estudo](#desc-dados)
  + [Escolha da Variável](#variavel)
  + [Tabela de Frequência e Histograma](#tabela-hist)
  + [Hipóteses](#hipoteses)
  + [Regressão Linear Simples](#regressao)
  + [Testes de Ajustamento](#testes-ajustamento)
    
+ [3. Referências](#ref)
 + [3.1 Documentação Não Eletrónica](#ref-offline)
  + [3.2 Documentação Eletrónica](#ref-online)

******

## **1. Descrição dos Dados** {#desc}

```{r, eval = T}
# importar
library(knitr) #R Markdown
library(here) # nice pathing
library(readr) # read files
library(Rcmdr) # R Commander
```
O presente trabalho tem o intuito de realizar uma análise descritiva ao dataset Algerian Forest Fire, disponível em https://archive.ics.uci.edu/ml/datasets/Algerian+Forest+Fires+Dataset++. Este dataset contém 244 instâncias observadas entre Junho e Setembro de 2012, e estas encontram-se agrupadas em duas regiões da Argélia, Nordeste (Bejaia) e Noroeste (Sidi Bel-abbes).
O dataset é composto oficialmente por 12 variáveis, ao qual a variável Date encontra-se repartida em três colunas distintas, disponíveis no ficheiro csv.
 
- Date
- Temperature (Temp)
- Relative Humidity (RH)
- Wind Speed (Ws)
- Rain
- Fine Fuel Moisture Code (FFMC)
- Duff Moisture Code (cnt)
- Drought Code (DC)
- Initial Spread Index (atemp)
- templdup Index (temp)
- Fire Weather Index (FWI)
- Classes

```{r, eval = T}
# Funcoes

# Stuges
sturges <- function(x)
{
  floor((1 + log(length(x)) / log(2)))
}

# Amplitude
amplitude <- function(x)
{
  max <- max(x)
  min <- min(x)
  nclass <- sturges(x)
  (max -min) / nclass
}
```

```{r, eval = TRUE}
# importar dataset
# alterar caminho para o vosso
# importar dataset
hour.dataset <- "D:/LEI/matematica/Metodos_Estatisticos/2122/ME_Trabalhos_2122/hour.csv"

# Todos os alugueres todas as horas
hour <- read.csv(file = hour.dataset)

# Todos os alugueres entre as 7 às 18
hour.day <- subset(hour, 6<atemp & atemp<19)

# Todos os alugueres entre as 19 às 6
hour.night <- subset(hour, atemp>18 | atemp<7)

# Ver tabelas importadas no RStudio
View(hour)
```

## **2. Dados em Estudo** {#desc-dados}

A nossa análise irá contemplar a região Nordeste da Argélia (Bejaia) usando os métodos matemáticos sobre regressão linear simples.

### **Escolha da Variável** {#variavel}

A variável em estudo é a *Initial Spread Index* (atemp) e é uma variável contínua.

### **Tabela de Frequência e Histograma** {#tabela-hist}

Para a escolha da variável, fez-se os cálculos necessários para a criação da tabela de frequências.

```{r, evail = T}
# min max
cat("Mínimo\n")
hour.atemp.min <- min(hour$atemp)
hour.atemp.min

cat("\nMáximo\n")
hour.atemp.max <- max(hour$atemp)
hour.atemp.max

# formula de sturges
cat("\nNúmero de classes\n")
hour.atemp.sturges.nclass <- sturges(hour$atemp)
hour.atemp.sturges.nclass

# amplitude da classe
cat("\nAmplitude da classe\n")
hour.atemp.sturges.amplitude <- amplitude(hour$atemp)
hour.atemp.sturges.amplitude

# tabela de frequencias
cat("\nClasses\n")
hour.atemp.sturges.breaks <- seq(hour.atemp.min, hour.atemp.max, hour.atemp.sturges.amplitude)
hour.atemp.sturges.breaks

cat("\nTabela de frequências")
table(cut(hour$atemp, breaks=hour.atemp.sturges.breaks))
```

A tabela atual só regista 118 valores da amostra, embora o número total de valores são 122. Esta anómalia só afeta quando colocamos os dados sob a forma de tabela no ambiente R Studio, sendo que os cálculos realizados contabilizam os 122 valores da amostra.

Após a criação da tabela de frequências, calculou-se a média e variância da variável atemp, e de seguida criou-se o seu histograma, de forma a ser possível tirar conclusões.

```{r, eval=TRUE}
# media e variancia
cat("\nMédia\n")
x <- mean(hour$atemp)
x

cat("\nVariância\n")
s <- var(hour$atemp)
s

# histograma
hist(hour$atemp, main="Histograma atemp", xlab="atemp",  ylab="Indice", nclass=hour.atemp.sturges.nclass)
```

Através do histograma, conseguimos verificar graficamente que a variável parece ter uma distritempção Exponêncial, conseguindo comprovar de acordo com a proposição de que a variância é o quadrado do valor esperado.

Média = 3.655738
Variância = 9.131083

Embora estes valores não sejam exatos, podem ser considerados corretos por serem apróximados.

A nossa distritempção Exponêncial contabiliza o tempo do índice de alastramento inicial de fogo (atemp), em dias (122) num periodo de 4 meses, em Bejaia (nordeste) da floresta da Argélia.

### **Hipóteses** {#hipoteses}

H0 − Os dados provêm da população com a distritempção exponencial.

H1 − Os dados não provêm da população com a distritempção exponencial.

```{r, eval = TRUE}
var(hour$atemp)
mean(hour$atemp)
chisq.test(table(hour$atemp))
qchisq(.10, df=66)
``` 

No nível de significância de 10% tem como 0.9375 > 0.10 então não se rejeita a hipótese nula (H0).

Com  base  na  amostra  e  ao  nível  de  signifiância  de 10%,  conclui-se que os tempos de falha seguem uma distritempsão Exponencial.

```{r, eval = TRUE}
var(hour.day$atemp)
mean(hour.day$atemp)
chisq.test(table(hour.day$atemp))
qchisq(.10, df=40)
```

No nível de significância de 10% tem como 0.9894 >  0.10 então não se rejeita a hipótese nula (H0).

Com  base  na  amostra  e  ao  nível  de  signifiância  de 10%,  conclui-se que os tempos de falha seguem uma distritempsão Exponencial.

```{r, eval = TRUE}
#df: graus de liberdade
var(hour.night$atemp)
mean(hour.night$atemp)
chisq.test(table(hour.night$atemp))
qchisq(.10, df=27)
```
No nível de significância de 10% tem como 0.8261 > 0.10 então não se rejeita a hipótese nula (H0). 

Com  base  na  amostra  e  ao  nível  de  signifiância  de 10%,  conclui-se que os tempos de falha seguem uma distritempsão Exponencial.


### **Regressão Linear Simples** {#regressao}

O modelo de correlação linear estudado no trabalho anterior, entre as variáveis contínuas cnt (independente) e temp (dependente), comprova ter uma forte correlação linear, deste modo, os residuos por norma deverão de ter uma distritempção Normal.

```{r, eval = TRUE}
regressao <- lm(hour$temp ~ hour$cnt)
regressao

regressao2 <- lm(hour.day$temp ~ hour.day$cnt)
regressao3 <- lm(hour.night$temp ~ hour.night$cnt)


residuos <- resid(regressao)
residuos2 <- resid(regressao2)
residuos3 <- resid(regressao3)

cat("\nTabela de frequências")
table(sort(residuos))

cat("\nTabela de frequências Com Fogo")
table(sort(residuos2))

cat("\nTabela de frequências Não Fogo")
table(sort(residuos3))
```

Os resíduos seguem uma distritempção normal porque é simétrica relativamente à recta x = μ atinge um máximo absoluto no ponto x = μ, tem dois pontos de inflexão em x = μ +- σ e que o eixo OX é uma assímptota horizontal ao seu gráfico. 
```{r, eval = TRUE}
hist(residuos, main="Residuos", xlab="Residuos", ylab="Indice")
``` 
O valor entre 5 e 6 é considerado um outlier porque não sabemos bem sobre os dados de forma a poder remover dos dados oficiais da regressao linear. 

### **Testes de Ajustamento** {#testes-ajustamento}

Realização dos testes de ajustamento de Kolmogorov-Smirnov, assim como, através da região crítica e do valor-p

```{r, eval = TRUE}
ks.test(hour$temp, hour$cnt)
rc =1.36  / sqrt(length(residuos))
rc
``` 
Dobs = 0.12295 e RC=[0.1231286,+∞]
Como 0.12295 não pertence à Região Critíca então não se rejeita a hipótese H0.

Como valor-p= 0.315 > 0.05 = α então não se rejeita a hipotese nula.

```{r, eval = TRUE}

ks.test(hour.day$temp, hour.day$cnt)
rc =1.36  / sqrt(length(residuos2))
rc
```
Dobs = 0.20339 e RC=[0.1770569,+∞]
Como 0.20339 pertence à Região Critíca então rejeita a hipótese H0.
Como valor-p= 0.1741 > 0.05 = α então não se rejeita a hipotese nula

Os resultados na região critica contradizem os resultados com o Valor-P. Esta contradição pode ser devido a que durante o cálculo da Região Crítica não se encontram tabulados porque n > 40 resultando um valor aproximado. 
Como Valor-P é um valor exato, ao qual consideramos fiável, concluindo que a H0 de não é rejeitada.

```{r, eval = TRUE}
ks.test(hour.night$temp, hour.night$cnt)
rc =1.36  / sqrt(length(residuos3))
rc
```
Dobs = 0.12698 e RC=[0.1713439,+∞]
Como 0.12698 pertence à Região Critíca então rejeita a hipótese H0.
Como valor-p= 0.12698 > 0.05 = α então não se rejeita a hipotese nula.

******

## **3. Referências** {#ref}

### 3.1 Documentação Não Eletrónia {#ref-offline}

  1. O'Reilly, Hadley Wickham & Garrett Glomund - R for Data Science.(2021)

### 3.2 Documentação Eletrónica {#ref-online}

  1. MOODLE IPS, UNIDADE CURRICULAR MÉTODOS ESTATÍSTICOS - Capítulo 2 - Regressão Linear Simples. [Consulta 2021-??-04]. Disponível na Internet: https://moodle.ips.pt/2021/mod/resource/view.php?id=81565
  
  2. MOODLE IPS, UNIDADE CURRICULAR MÉTODOS ESTATÍSTICOS - Sebenta - Regressão Linear Simples (capítulo 2). [Consulta 2021-??-04]. Disponível na Internet: https://moodle.ips.pt/2021/mod/resource/view.php?id=102474
  
  3. MOODLE IPS, UNIDADE CURRICULAR MÉTODOS ESTATÍSTICOS - Ficha de Trabalho 4 - Regressão Linear Simples. [Consulta 2021-??-04]. Disponível na Internet: https://moodle.ips.pt/2021/mod/resource/view.php?id=98992
  
  4. MOODLE IPS, UNIDADE CURRICULAR MÉTODOS ESTATÍSTICOS - Ficha de Trabalho 5 - Regressão Linear Simples. [Consulta 2021-??-04]. Disponível na Internet: https://moodle.ips.pt/2021/mod/resource/view.php?id=108002
  
  5. Learn by Marketing - Linear regression in R. [Consulta 2021-6-05]. Disponível na Internet: http://www.learnbymarketing.com/tutorials/linear-regression-in-r/
  